(this.webpackJsonpexample=this.webpackJsonpexample||[]).push([[0],{139:function(e,n,t){e.exports=t(242)},144:function(e,n,t){},242:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),c=t(9),o=t.n(c),i=(t(144),t(121)),u=t(56),l=t.n(u),s=t(92),f=t(57),p=t(19),d=t(16),m=t(17),v=t(31),b=t(243);t(64);function E(e,n,t,r){return new(t||(t=Promise))((function(a,c){function o(e){try{u(r.next(e))}catch(n){c(n)}}function i(e){try{u(r.throw(e))}catch(n){c(n)}}function u(e){e.done?a(e.value):new t((function(n){n(e.value)})).then(o,i)}u((r=r.apply(e,n||[])).next())}))}function h(e,n){var t,r,a,c,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return c={next:i(0),throw:i(1),return:i(2)},"function"===typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function i(c){return function(i){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=n.call(e,o)}catch(i){c=[6,i],r=0}finally{t=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,i])}}}var y="P2P_CHAT_CHANNEL_LABEL";function g(e){var n,t=e.remoteDescription,r=e.iceServers,a=void 0===r?[]:r,c=e.onChannelOpen,o=e.onMessageReceived,i=new RTCPeerConnection({iceServers:a});function u(e){i.setRemoteDescription(JSON.parse(e))}function l(e){n&&n.send(e)}return new Promise((function(e){i.onicecandidate=function(n){null===n.candidate&&(console.log(i.localDescription),e({localDescription:JSON.stringify(i.localDescription),setAnswerDescription:u,sendMessage:l}))},t?(i.ondatachannel=function(e){var t=e.channel;(n=t).onopen=function(){c()},n.onmessage=function(e){o(e.data)}},function(e){E(this,void 0,void 0,(function(){var n;return h(this,(function(t){switch(t.label){case 0:return[4,i.setRemoteDescription(JSON.parse(e))];case 1:return t.sent(),[4,i.createAnswer()];case 2:return n=t.sent(),i.setLocalDescription(n),[2]}}))}))}(t)):(function(){try{(n=i.createDataChannel(y)).onopen=function(){c()},n.onmessage=function(e){o(e.data)}}catch(e){console.error("No data channel (peerConnection)",e)}}(),function(){E(this,void 0,void 0,(function(){var e;return h(this,(function(n){switch(n.label){case 0:return[4,i.createOffer()];case 1:return e=n.sent(),i.setLocalDescription(e),[2]}}))}))}())}))}var O,S=t(245);t(49);function w(){var e=Object(d.a)([""]);return w=function(){return e},e}function j(){var e=Object(d.a)([""]);return j=function(){return e},e}function x(){var e=Object(d.a)(["\n          text-align: right;\n        "]);return x=function(){return e},e}function D(){var e=Object(d.a)(["\n  ",";\n"]);return D=function(){return e},e}function T(){var e=Object(d.a)([""]);return T=function(){return e},e}!function(e){e.ME="ME",e.STRANGER="STRANGER"}(O||(O={}));var C,P=m.b.form(T()),z=m.b.div(D(),(function(e){return e.sender===O.ME?Object(m.a)(x()):""})),A=m.b.div(j()),k=m.b.div(w()),N=function(e){var n=e.messages,t=e.sendMessage,r=a.a.useState(""),c=Object(p.a)(r,2),o=c[0],i=c[1];return a.a.createElement(k,null,a.a.createElement(A,null,n.map((function(e){return a.a.createElement(z,{key:e.id,sender:e.sender},e.payload)}))),a.a.createElement(P,{onSubmit:function(e){e.preventDefault(),e.stopPropagation(),t(o),i("")}},a.a.createElement(S.a,{type:"text",placeholder:"Message...",value:o,onChange:function(e){e.preventDefault(),e.stopPropagation(),i(e.target.value)}})))};!function(e){e.TEXT="TEXT"}(C||(C={}));var R=t(67),M=t.n(R),B=t(126),J=t.n(B),L=t(97),H=t(91),W=t.n(H);function F(){var e=L.lib.WordArray.random(16),n=L.lib.WordArray.random(16);return W()(e,n,{keySize:8,iterations:1e3}).toString()}var G=t(100),V=(t(102),t(244));t(88);function X(){var e=Object(d.a)(["\n  padding-top: ",";\n"]);return X=function(){return e},e}var K=m.b.div(X(),(function(e){var n=e.size;return"".concat(n,"px")})),_=t(127),I=function(e){return"string"===typeof e&&e.length>0?void 0:"required"},q=Object(_.a)({description:I,encryptionKey:I});function $(e){return v.Base64.encode(JSON.stringify(e))}function Q(e){return JSON.parse(v.Base64.decode(e))}var U,Y=function(e){var n=e.onHost,t=e.onSlave,r=a.a.useState(""),c=Object(p.a)(r,2),o=c[0],i=c[1],u=a.a.useState(""),l=Object(p.a)(u,2),s=l[0],f=l[1];return a.a.createElement(a.a.Fragment,null,a.a.createElement(b.a,null,a.a.createElement(G.a,{onClick:function(e){e.preventDefault(),e.stopPropagation(),n()},type:"primary",block:!0},"New chat")),a.a.createElement(K,{size:24}),a.a.createElement(b.a,null,a.a.createElement("form",{onSubmit:function(e){e.preventDefault(),e.stopPropagation();try{var n=Q(o);if(q(n))throw new Error;t(n)}catch(s){f("Connection Description invalid!")}}},a.a.createElement(S.a,{type:"text",value:o,onChange:function(e){e.preventDefault(),e.stopPropagation(),f(""),i(e.target.value)},placeholder:"Paste Connection Description here..."}),!!s&&a.a.createElement(a.a.Fragment,null,a.a.createElement(K,{size:8}),a.a.createElement(V.a.Text,null,s)),a.a.createElement(K,{size:12}),a.a.createElement(G.a,{type:"primary",htmlType:"submit",block:!0},"Join a chat"))))},Z=t(46),ee=t.n(Z),ne=function(e){var n=e.connectionDescription,t=e.onSubmit,r=a.a.useState(""),c=Object(p.a)(r,2),o=c[0],i=c[1],u=a.a.useState(""),l=Object(p.a)(u,2),s=l[0],f=l[1],d=$(n);return a.a.createElement(b.a,null,a.a.createElement(V.a.Text,null,"Send this code to other person:"),a.a.createElement(K,{size:4}),a.a.createElement(S.a.Search,{type:"text",value:d,enterButton:"Copy to clipboard",onSearch:function(){ee()(d)}}),a.a.createElement(K,{size:24}),a.a.createElement(V.a.Text,null,"Code from your buddy:"),a.a.createElement(K,{size:4}),a.a.createElement(S.a.Search,{type:"text",value:o,onChange:function(e){e.preventDefault(),e.stopPropagation(),f(""),i(e.target.value)},placeholder:"Paste an answer code",enterButton:"Connect",onSearch:function(){try{var e=Q(o);if(q(e))throw new Error;t(e)}catch(s){f("Connection Description invalid!")}}}),!!s&&a.a.createElement(a.a.Fragment,null,a.a.createElement(K,{size:8}),a.a.createElement(V.a.Text,null,s)))},te=function(e){var n=$(e.connectionDescription);return a.a.createElement(b.a,null,a.a.createElement(V.a.Text,null,"Send this code to other person:"),a.a.createElement(K,{size:4}),a.a.createElement(S.a.Search,{type:"text",value:n,enterButton:"Copy to clipboard",onSearch:function(){ee()(n)}}))};function re(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function ae(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?re(t,!0).forEach((function(n){Object(i.a)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):re(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function ce(){var e=Object(d.a)(["\n  padding: 12px;\n  max-width: 400px;\n  margin: 0 auto;\n"]);return ce=function(){return e},e}function oe(){var e=Object(d.a)(["\n  text-align: center;\n  font-size: 16px;\n  font-weight: 700;\n"]);return oe=function(){return e},e}function ie(){var e=Object(d.a)(["\n  text-align: center;\n  font-size: 12px;\n"]);return ie=function(){return e},e}function ue(){var e=Object(d.a)(["\n  text-align: center;\n  font-size: 10px;\n"]);return ue=function(){return e},e}function le(){var e=Object(d.a)([""]);return le=function(){return e},e}function se(){var e=Object(d.a)(["\n  font-size: 12px;\n  font-weight: 700;\n"]);return se=function(){return e},e}function fe(){var e=Object(d.a)(["\n  font-size: 10px;\n"]);return fe=function(){return e},e}!function(e){e.HOST="HOST",e.SLAVE="SLAVE"}(U||(U={}));var pe=m.b.pre(fe()),de=m.b.div(se()),me=m.b.div(le()),ve=m.b.div(ue()),be=m.b.div(ie()),Ee=m.b.div(oe()),he=m.b.div(ce()),ye=[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:turn.anyfirewall.com:443?transport=tcp",username:"webrtc",credential:"webrtc"}],ge=function(){var e=a.a.useState(),n=Object(p.a)(e,2),t=n[0],r=n[1],c=a.a.useState(!1),o=Object(p.a)(c,2),i=o[0],u=o[1],d=a.a.useState(),m=Object(p.a)(d,2),E=m[0],h=m[1],y=a.a.useState(),S=Object(p.a)(y,2),w=S[0],j=S[1],x=a.a.useState([]),D=Object(p.a)(x,2),T=D[0],P=D[1],z=a.a.useState([]),A=Object(p.a)(z,2),k=A[0],R=A[1],B=a.a.useRef(),L=a.a.useRef(),H=function(e){return function(n){if(e)try{var t=(a=n,c=e,M.a.decrypt(a,c).toString(J.a)),r=JSON.parse(t);P((function(e){return[n].concat(Object(f.a)(e))})),R((function(e){return[].concat(Object(f.a)(e),[r])}))}catch(o){}var a,c}},W=function(){return u(!0)},G=function(){var e=Object(s.a)(l.a.mark((function e(){var n,t,a,c,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=F(),h(n),e.next=4,g({iceServers:ye,onMessageReceived:H(n),onChannelOpen:W});case 4:t=e.sent,a=t.localDescription,c=t.setAnswerDescription,o=t.sendMessage,r(U.HOST),L.current=o,B.current=c,j(v.Base64.encode(a));case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=Object(s.a)(l.a.mark((function e(n){var t,a,c,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.encryptionKey,h(t),e.next=4,g({iceServers:ye,remoteDescription:v.Base64.decode(n.description),onMessageReceived:H(t),onChannelOpen:W});case 4:a=e.sent,c=a.localDescription,o=a.sendMessage,r(U.SLAVE),L.current=o,j(v.Base64.encode(c));case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),X={description:w,encryptionKey:E},_=k.filter((function(e){return e.type===C.TEXT}));return a.a.createElement(he,null,a.a.createElement(Ee,{style:{textAlign:"center"}},"pitu-pitu"),a.a.createElement(be,{style:{textAlign:"center"}},"p2p chat on WebRTC with additional AES256 encryption"),a.a.createElement(K,{size:24}),!t&&a.a.createElement(Y,{onHost:G,onSlave:V}),t===U.HOST&&!i&&a.a.createElement(ne,{connectionDescription:X,onSubmit:function(e){B.current&&B.current(v.Base64.decode(e.description))}}),t===U.SLAVE&&!i&&a.a.createElement(te,{connectionDescription:X}),t&&i&&a.a.createElement(N,{messages:_,sendMessage:function(e){if(L.current&&E){var n={id:Math.random().toFixed(10),sender:O.STRANGER,type:C.TEXT,payload:e},t=JSON.stringify(n),r=(a=t,c=E,M.a.encrypt(a,c).toString());L.current(r),P((function(e){return[r].concat(Object(f.a)(e))})),R((function(e){return[].concat(Object(f.a)(e),[ae({},n,{sender:O.ME})])}))}var a,c}}),a.a.createElement(K,{size:24}),a.a.createElement(ve,null,"v2.0.0"),a.a.createElement(K,{size:64}),a.a.createElement(b.a,null,a.a.createElement(me,null,a.a.createElement(de,null,"ICE Servers used to establish connection:"),a.a.createElement(pe,null,JSON.stringify(ye,null,2))),a.a.createElement(me,null,a.a.createElement(de,null,"Encryption key:"),a.a.createElement(pe,null,E)),a.a.createElement(me,null,a.a.createElement(de,null,"Encrypted messages:"),a.a.createElement(pe,null,JSON.stringify(T,null,2)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(ge,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[139,1,2]]]);
//# sourceMappingURL=main.28ae8e86.chunk.js.map