(window.webpackJsonpexample=window.webpackJsonpexample||[]).push([[0],{122:function(e,n,t){e.exports=t(204)},127:function(e,n,t){},204:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),c=t(8),o=t.n(c),i=(t(127),t(106)),u=t(47),s=t.n(u),l=t(79),f=t(87),p=t(28),d=t(18),v=t(19),h=t(48),m=t(56),b=t.n(m),y=t(209),E=(t(62),t(207)),O=(t(205),t(86)),g=(t(89),t(208));t(206);function w(){var e=Object(d.a)(["\n  padding-top: ",";\n"]);return w=function(){return e},e}var S=v.b.div(w(),(function(e){var n=e.size;return"".concat(n,"px")}));function x(e,n,t,r){return new(t||(t=Promise))((function(a,c){function o(e){try{u(r.next(e))}catch(n){c(n)}}function i(e){try{u(r.throw(e))}catch(n){c(n)}}function u(e){e.done?a(e.value):new t((function(n){n(e.value)})).then(o,i)}u((r=r.apply(e,n||[])).next())}))}function j(e,n){var t,r,a,c,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return c={next:i(0),throw:i(1),return:i(2)},"function"===typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function i(c){return function(i){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=n.call(e,o)}catch(i){c=[6,i],r=0}finally{t=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,i])}}}var T,D="P2P_CHAT_CHANNEL_LABEL";function C(e){var n,t=e.remoteDescription,r=e.onChannelOpen,a=e.onMessageReceived,c=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:turn.anyfirewall.com:443?transport=tcp",username:"webrtc",credential:"webrtc"}]});function o(e){c.setRemoteDescription(JSON.parse(e))}function i(e){n&&n.send(e)}return new Promise((function(e){c.onicecandidate=function(n){null===n.candidate&&e({localDescription:JSON.stringify(c.localDescription),setAnswerDescription:o,sendMessage:i})},t?(c.ondatachannel=function(e){var t=e.channel;(n=t).onopen=function(){r()},n.onmessage=function(e){a(e.data)}},function(e){x(this,void 0,void 0,(function(){var n;return j(this,(function(t){switch(t.label){case 0:return[4,c.setRemoteDescription(JSON.parse(e))];case 1:return t.sent(),[4,c.createAnswer()];case 2:return n=t.sent(),c.setLocalDescription(n),[2]}}))}))}(t)):(function(){try{(n=c.createDataChannel(D)).onopen=function(){r()},n.onmessage=function(e){a(e.data)}}catch(e){console.error("No data channel (peerConnection)",e)}}(),function(){x(this,void 0,void 0,(function(){var e;return j(this,(function(n){switch(n.label){case 0:return[4,c.createOffer()];case 1:return e=n.sent(),c.setLocalDescription(e),[2]}}))}))}())}))}function k(){var e=Object(d.a)([""]);return k=function(){return e},e}function P(){var e=Object(d.a)([""]);return P=function(){return e},e}function A(){var e=Object(d.a)(["\n    text-align: right;\n  "]);return A=function(){return e},e}function M(){var e=Object(d.a)(["\n  ",";\n"]);return M=function(){return e},e}function R(){var e=Object(d.a)([""]);return R=function(){return e},e}!function(e){e.ME="ME",e.STRANGER="STRANGER"}(T||(T={}));var N,B,z=v.b.form(R()),L=v.b.div(M(),(function(e){return e.sender===T.ME?Object(v.a)(A()):""})),J=v.b.div(P()),H=v.b.div(k()),G=function(e){var n=e.messages,t=e.sendMessage,r=a.a.useState(""),c=Object(p.a)(r,2),o=c[0],i=c[1];return a.a.createElement(H,null,a.a.createElement(J,null,n.map((function(e){return a.a.createElement(L,{key:e.id,sender:e.sender},e.payload)}))),a.a.createElement(z,{onSubmit:function(e){e.preventDefault(),e.stopPropagation(),t(o),i("")}},a.a.createElement(y.a,{type:"text",placeholder:"Message...",value:o,onChange:function(e){e.preventDefault(),e.stopPropagation(),i(e.target.value)}})))};function V(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function X(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?V(t,!0).forEach((function(n){Object(i.a)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):V(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function _(){var e=Object(d.a)(["\n  padding: 12px;\n  max-width: 400px;\n  margin: 0 auto;\n"]);return _=function(){return e},e}function W(){var e=Object(d.a)(["\n  text-align: center;\n  font-size: 10px;\n"]);return W=function(){return e},e}!function(e){e.TEXT="TEXT"}(N||(N={})),function(e){e.HOST="HOST",e.SLAVE="SLAVE"}(B||(B={}));var F=v.b.div(W()),I=v.b.div(_()),$=function(){var e=a.a.useState(),n=Object(p.a)(e,2),t=n[0],r=n[1],c=a.a.useState(!1),o=Object(p.a)(c,2),i=o[0],u=o[1],d=a.a.useState(),v=Object(p.a)(d,2),m=v[0],w=v[1],x=a.a.useState(""),j=Object(p.a)(x,2),D=j[0],k=j[1],P=a.a.useState([]),A=Object(p.a)(P,2),M=A[0],R=A[1],z=a.a.useRef(),L=a.a.useRef(),J=function(e){try{var n=JSON.parse(e);R((function(e){return[].concat(Object(f.a)(e),[n])}))}catch(t){}},H=function(){return u(!0)},V=function(){var e=Object(l.a)(s.a.mark((function e(){var n,t,a,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r(B.HOST),e.next=3,C({onMessageReceived:J,onChannelOpen:H});case 3:n=e.sent,t=n.localDescription,a=n.setAnswerDescription,c=n.sendMessage,L.current=c,z.current=a,w(h.Base64.encode(t));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=function(e){k(e.target.value)},W=function(){var e=Object(l.a)(s.a.mark((function e(){var n,t,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!D){e.next=9;break}return r(B.SLAVE),e.next=4,C({remoteDescription:h.Base64.decode(D),onMessageReceived:J,onChannelOpen:H});case 4:n=e.sent,t=n.localDescription,a=n.sendMessage,L.current=a,w(h.Base64.encode(t));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$=function(){m&&b()(m)},q=M.filter((function(e){return e.type===N.TEXT}));return a.a.createElement(I,null,a.a.createElement(g.a.Title,{style:{textAlign:"center"}},"p2p chat"),!t&&a.a.createElement("div",null,a.a.createElement(E.a,null,a.a.createElement(O.a,{onClick:V,type:"primary",block:!0},"New chat")),a.a.createElement(S,{size:24}),a.a.createElement(E.a,null,a.a.createElement(y.a,{type:"text",value:D,onChange:_,placeholder:"Paste connection code here..."}),a.a.createElement(S,{size:12}),a.a.createElement(O.a,{onClick:W,type:"primary",block:!0},"Join a chat"))),t===B.HOST&&!i&&a.a.createElement("div",null,a.a.createElement(g.a.Text,null,"Send this code to other person:"),a.a.createElement(S,{size:4}),a.a.createElement(y.a.Search,{type:"text",value:m||"preparing connection...",enterButton:"Copy to clipboard",onSearch:$}),a.a.createElement(S,{size:24}),a.a.createElement(g.a.Text,null,"Code from your buddy:"),a.a.createElement(S,{size:4}),a.a.createElement(y.a.Search,{type:"text",value:D,onChange:_,placeholder:"Paste an answer code",enterButton:"Connect",onSearch:function(){D&&z.current&&z.current(h.Base64.decode(D))}})),t===B.SLAVE&&!i&&a.a.createElement("div",null,a.a.createElement(g.a.Text,null,"Send this code to other person:"),a.a.createElement(S,{size:4}),a.a.createElement(y.a.Search,{type:"text",value:m||"preparing connection...",enterButton:"Copy to clipboard",onSearch:$})),t&&i&&a.a.createElement(G,{messages:q,sendMessage:function(e){if(L.current){var n={id:Math.random().toFixed(10),sender:T.STRANGER,type:N.TEXT,payload:e};L.current(JSON.stringify(n)),R((function(e){return[].concat(Object(f.a)(e),[X({},n,{sender:T.ME})])}))}}}),a.a.createElement(S,{size:24}),a.a.createElement(F,null,"v0.0.6"))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement($,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[122,1,2]]]);
//# sourceMappingURL=main.5b2f63ce.chunk.js.map